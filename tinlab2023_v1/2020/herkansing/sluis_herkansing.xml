<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'>
<nta>
	<declaration>// Place global declarations here.
/*
Project working

AtArrival
StoplightRed
DoorOpen
StoplightGreen
Startmove
Sensor
SchipEntered
Doorclosed
StoplightRed
---------
Nivelleer started
NIvelleer stopped
Waterlevel equilibrium
-----------
AtLeaving
Stoplightred
Dooropened
Stoplightgreen
StartMove
Sensor
SchipHasLeft
Doorclosed
StoplightRed


Uitleg
Als het schip boven is, dan is waterlvel gelijk aan hoog, filling valve is dicht, lower gates zijn gesloten, uppergates zijn open,empty valve is dicht. 
Schip is in waterlock, waterlevel is hoog, filling valve is dicht, lower gates gesloten, upper gates gesloten, empty valve is open. 
Schip is dan laag, waterlevel gelijk aan laag, filling valve is dicht, lowergates zijn open, uppergates zijn dicht, empty valve is dicht.
AtArrivalHigh

AtArrivalLow
Als schip beneden is dan is waterlevel gelijk aan laag, filling valve is dicht, lower gates zijn open, upper gates zijn dicht, empty valve is open. 
Schip is in water lock, waterlevel is laag, flilling valve is open, lower gates zijn gesloten, upper gates zij gesloten, empty valve is dicht,. 
Schip is dan hoog, waterlevel is gelijk aan hoog, filling valve is dicht, uppergates zijn open, lowergates zijn dicht, filling valve is dicht


*/

const int N = 2;         // # trains
typedef int[0,N-1] id_t;

chan        appr[N], stop[N], leave[N];
urgent chan go[N];

// waterniveau in in meter van 0 tot 10
typedef int[3,10] waterniveau;

waterniveau level;


//doors
chan lower_gate;
chan upper_gate;
//filling
chan emptying_valve;
chan filling_valve;
bool nivelleer_sessie_bezig;
// water level
chan high_water_level;
chan low_water_level;
//sluices
chan signal_sluis_low[N];
chan signal_sluis_high[N];
//
chan move[N];
//
chan groen;
chan rood;

clock central;</declaration>
	<template>
		<name x="5" y="5">schip</name>
		<parameter>const id_t id</parameter>
		<declaration>// Place local declarations here.
clock schip_clock;</declaration>
		<location id="id0" x="238" y="68">
			<name x="272" y="59">Signal_sluis_low</name>
		</location>
		<location id="id1" x="-68" y="-204">
			<name x="-78" y="-238">Signal_sluis_high</name>
		</location>
		<location id="id2" x="136" y="136">
			<name x="170" y="136">AtEnteringLow</name>
		</location>
		<location id="id3" x="136" y="0">
			<name x="126" y="-34">AtArrivalLow</name>
		</location>
		<location id="id4" x="0" y="-102">
			<name x="-10" y="-136">AtArrivalHigh</name>
		</location>
		<location id="id5" x="-136" y="-102">
			<name x="-263" y="-136">AtEnteringHigh</name>
		</location>
		<location id="id6" x="0" y="136">
			<name x="-10" y="102">AtLeavingLow</name>
		</location>
		<location id="id7" x="-136" y="0">
			<name x="-255" y="-8">AtLeavingHigh</name>
			<urgent/>
		</location>
		<location id="id8" x="0" y="0">
		</location>
		<init ref="id8"/>
		<transition>
			<source ref="id2"/>
			<target ref="id6"/>
		</transition>
		<transition>
			<source ref="id0"/>
			<target ref="id2"/>
			<label kind="synchronisation" x="238" y="102">move[id]?</label>
		</transition>
		<transition>
			<source ref="id3"/>
			<target ref="id0"/>
			<label kind="synchronisation" x="154" y="17">signal_sluis_low[id]!</label>
			<label kind="assignment" x="154" y="34">schip_clock:=0</label>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id3"/>
			<label kind="guard" x="18" y="-34">schip_clock&gt;5</label>
			<label kind="synchronisation" x="18" y="-17">lower_gate?</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id8"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id8"/>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id7"/>
		</transition>
		<transition>
			<source ref="id1"/>
			<target ref="id5"/>
			<label kind="synchronisation" x="-118" y="-170">move[id]?</label>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id1"/>
			<label kind="synchronisation" x="-50" y="-170">signal_sluis_high[id]!</label>
			<label kind="assignment" x="-50" y="-153">schip_clock:=0</label>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id4"/>
			<label kind="guard" x="0" y="-85">schip_clock&gt;5</label>
			<label kind="synchronisation" x="0" y="-68">upper_gate?</label>
		</transition>
	</template>
	<template>
		<name>sluis</name>
		<declaration>const int water_laag=3;
const int water_hoog=10;
const int water_median=(water_hoog+water_laag)/2;
int[water_laag,water_hoog] water=water_median;
// level wordt gelijk gezet met temp
// temp is gelijk aan waterniveau
clock sluis_clock;
id_t list[N+1];
int[0,N] len;
bool contentHigh, contentLow;
// Put an element at the end of the queue
void enqueue(id_t element)
{
        list[len++] = element;
}

// Remove the front element of the queue
void dequeue()
{
        int i = 0;
        len -= 1;
        while (i &lt; len)
        {
                list[i] = list[i + 1];
                i++;
        }
        list[i] = 0;
}

// Returns the front element of the queue
id_t front()
{
   return list[0];
}

// Returns the last element of the queue
id_t tail()
{
   return list[len - 1];
}</declaration>
		<location id="id9" x="170" y="170">
			<name x="160" y="136">S10</name>
			<urgent/>
		</location>
		<location id="id10" x="238" y="170">
			<name x="228" y="136">S9</name>
		</location>
		<location id="id11" x="-340" y="170">
		</location>
		<location id="id12" x="-170" y="170">
			<urgent/>
		</location>
		<location id="id13" x="-442" y="170">
			<name x="-452" y="136">S18</name>
		</location>
		<location id="id14" x="340" y="170">
			<name x="330" y="136">S8</name>
		</location>
		<location id="id15" x="510" y="136">
			<name x="500" y="102">S7</name>
		</location>
		<location id="id16" x="-510" y="136">
			<name x="-520" y="102">S17</name>
		</location>
		<location id="id17" x="510" y="0">
			<name x="518" y="-51">nivelleer_omhoog</name>
		</location>
		<location id="id18" x="-510" y="0">
			<name x="-476" y="-17">nivelleer_omlaag</name>
		</location>
		<location id="id19" x="510" y="-136">
			<name x="500" y="-170">S6</name>
		</location>
		<location id="id20" x="442" y="-136">
			<name x="432" y="-170">S5</name>
		</location>
		<location id="id21" x="340" y="-195">
			<name x="330" y="-229">entered_low</name>
		</location>
		<location id="id22" x="-510" y="-136">
			<name x="-520" y="-170">S16</name>
		</location>
		<location id="id23" x="-442" y="-136">
			<name x="-452" y="-170">S15</name>
		</location>
		<location id="id24" x="-340" y="-204">
			<name x="-425" y="-238">entered_high</name>
		</location>
		<location id="id25" x="238" y="-136">
			<name x="263" y="-153">allow_enter_low</name>
			<label kind="invariant" x="246" y="-127">list[len]&lt;3</label>
		</location>
		<location id="id26" x="-238" y="-136">
			<name x="-221" y="-161">allow_enter_high</name>
			<label kind="invariant" x="-314" y="-136">list[len]&lt;3</label>
		</location>
		<location id="id27" x="170" y="-102">
			<name x="42" y="-110">lower_gate_open</name>
		</location>
		<location id="id28" x="-170" y="-102">
			<name x="-136" y="-119">high_gate_open</name>
		</location>
		<location id="id29" x="170" y="0">
			<name x="160" y="-34">AtArrivalLow</name>
		</location>
		<location id="id30" x="-170" y="0">
			<name x="-280" y="0">AtArrivalHigh</name>
		</location>
		<location id="id31" x="0" y="0">
			<name x="-10" y="-34">Init</name>
		</location>
		<init ref="id31"/>
		<transition>
			<source ref="id11"/>
			<target ref="id12"/>
			<label kind="synchronisation" x="-322" y="153">rood!</label>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id31"/>
			<label kind="synchronisation" x="76" y="34">upper_gate!</label>
			<nail x="144" y="127"/>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id9"/>
			<label kind="synchronisation" x="195" y="187">rood!</label>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id10"/>
			<label kind="select" x="263" y="204">e : id_t</label>
			<label kind="synchronisation" x="255" y="178">move[e]!</label>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id14"/>
			<label kind="synchronisation" x="399" y="170">groen!</label>
			<nail x="476" y="136"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id15"/>
			<label kind="synchronisation" x="527" y="51">upper_gate!</label>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id17"/>
			<label kind="synchronisation" x="518" y="-110">high_water_level!</label>
			<label kind="assignment" x="527" y="-85">sluis_clock:=0</label>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="416" y="-119">lower_gate!</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="382" y="-204">rood!</label>
			<label kind="assignment" x="391" y="-187">sluis_clock:=0</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id21"/>
			<label kind="select" x="238" y="-212">e : id_t</label>
			<label kind="synchronisation" x="238" y="-195">move[e]!</label>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id25"/>
			<label kind="synchronisation" x="144" y="-161">groen!</label>
			<label kind="assignment" x="127" y="-178">sluis_clock:=0</label>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id27"/>
			<label kind="synchronisation" x="170" y="-68">lower_gate!</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id29"/>
			<label kind="select" x="18" y="-51">e : id_t</label>
			<label kind="synchronisation" x="18" y="-17">signal_sluis_low[e]?</label>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id31"/>
			<label kind="synchronisation" x="-170" y="59">lower_gate!</label>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id11"/>
			<label kind="select" x="-416" y="119">e : id_t</label>
			<label kind="synchronisation" x="-416" y="144">move[e]!</label>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id13"/>
			<label kind="synchronisation" x="-544" y="161">groen!</label>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id16"/>
			<label kind="synchronisation" x="-484" y="51">lower_gate!</label>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="-510" y="-85">low_water_level!</label>
			<label kind="assignment" x="-510" y="-68">sluis_clock:=0</label>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id22"/>
			<label kind="synchronisation" x="-493" y="-127">upper_gate!</label>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id23"/>
			<label kind="synchronisation" x="-408" y="-195">rood!</label>
			<label kind="assignment" x="-399" y="-161">sluis_clock:=0</label>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id24"/>
			<label kind="select" x="-297" y="-221">e : id_t</label>
			<label kind="synchronisation" x="-289" y="-195">move[e]!</label>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id26"/>
			<label kind="synchronisation" x="-255" y="-85">groen!</label>
			<label kind="assignment" x="-280" y="-102">sluis_clock:=0</label>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id28"/>
			<label kind="synchronisation" x="-144" y="-59">upper_gate!</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id30"/>
			<label kind="select" x="-127" y="-34">e : id_t</label>
			<label kind="synchronisation" x="-152" y="-17">signal_sluis_high[e]?</label>
		</transition>
	</template>
	<template>
		<name>sensor</name>
		<declaration>clock x;</declaration>
		<location id="id32" x="0" y="0">
		</location>
		<init ref="id32"/>
		<transition>
			<source ref="id32"/>
			<target ref="id32"/>
			<label kind="synchronisation" x="-170" y="0">upper_gate!</label>
			<nail x="-68" y="-68"/>
			<nail x="-68" y="68"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id32"/>
			<label kind="synchronisation" x="85" y="0">lower_gate!</label>
			<nail x="8" y="-8"/>
			<nail x="68" y="-68"/>
			<nail x="68" y="68"/>
		</transition>
	</template>
	<template>
		<name>stoplicht</name>
		<declaration>clock stoplicht_clock;</declaration>
		<location id="id33" x="136" y="0">
			<name x="126" y="-34">Groen</name>
		</location>
		<location id="id34" x="0" y="0">
			<name x="-10" y="-34">Rood</name>
		</location>
		<init ref="id34"/>
		<transition>
			<source ref="id33"/>
			<target ref="id34"/>
			<label kind="synchronisation" x="52" y="51">rood?</label>
			<nail x="102" y="68"/>
			<nail x="34" y="68"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id33"/>
			<label kind="synchronisation" x="52" y="-85">groen?</label>
			<nail x="34" y="-68"/>
			<nail x="102" y="-68"/>
		</transition>
	</template>
	<template>
		<name>deur</name>
		<location id="id35" x="170" y="0">
			<name x="160" y="-34">open_low</name>
		</location>
		<location id="id36" x="-170" y="0">
			<name x="-180" y="-34">open_high</name>
		</location>
		<location id="id37" x="0" y="0">
			<name x="-10" y="-34">Dicht</name>
		</location>
		<init ref="id37"/>
		<transition>
			<source ref="id35"/>
			<target ref="id37"/>
			<label kind="synchronisation" x="52" y="51">lower_gate?</label>
			<nail x="136" y="68"/>
			<nail x="34" y="68"/>
		</transition>
		<transition>
			<source ref="id37"/>
			<target ref="id35"/>
			<label kind="synchronisation" x="52" y="-85">lower_gate?</label>
			<nail x="34" y="-68"/>
			<nail x="136" y="-68"/>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id37"/>
			<label kind="synchronisation" x="-118" y="51">upper_gate?</label>
			<nail x="-136" y="68"/>
			<nail x="-34" y="68"/>
		</transition>
		<transition>
			<source ref="id37"/>
			<target ref="id36"/>
			<label kind="synchronisation" x="-118" y="-85">upper_gate?</label>
			<nail x="-34" y="-68"/>
			<nail x="-136" y="-68"/>
		</transition>
	</template>
	<template>
		<name>pomp</name>
		<declaration>const int water_laag=3;
const int water_hoog=10;
const int water_median=(water_hoog+water_laag)/2;
int[water_laag,water_hoog] water=water_median;
clock pomp_clock;
// waterniveau van de sensor voor de sluis is gelijk aan level
waterniveau depth;



// een constraint op een bepaalde variabele
bool isForLow()
{
//	return false;
	
	if( level&gt;=3) return true;
	else return false;

}

bool isForHigh()
{
//	return false;
	
	if( level&gt;=6) return true;
	//else if(level&gt;=6) return true;
		
	else return false;

}



//verschillende tijdseenheden voor even en oneven lampnummers
</declaration>
		<location id="id38" x="204" y="0">
			<name x="102" y="-17">pomp_water</name>
		</location>
		<location id="id39" x="-204" y="0">
			<name x="-187" y="-17">pomp_water_weg</name>
		</location>
		<location id="id40" x="0" y="0">
		</location>
		<init ref="id40"/>
		<transition>
			<source ref="id38"/>
			<target ref="id38"/>
			<label kind="synchronisation" x="297" y="34">level &lt;= water_hoog &amp;&amp; level &gt; water_median</label>
			<nail x="272" y="68"/>
			<nail x="306" y="34"/>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id38"/>
			<label kind="guard" x="306" y="-68">level==water_median</label>
			<nail x="272" y="-68"/>
			<nail x="306" y="-34"/>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id38"/>
			<label kind="guard" x="204" y="85">level&gt;water_hoog</label>
			<label kind="assignment" x="204" y="68">level--</label>
			<nail x="204" y="68"/>
			<nail x="238" y="68"/>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id38"/>
			<label kind="guard" x="204" y="-102">level &lt; water_median</label>
			<label kind="assignment" x="204" y="-93">level++</label>
			<nail x="204" y="-68"/>
			<nail x="238" y="-68"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id39"/>
			<label kind="guard" x="-612" y="34">level &gt;= water_laag &amp;&amp; level &lt;= water_median</label>
			<nail x="-272" y="68"/>
			<nail x="-306" y="34"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id39"/>
			<label kind="guard" x="-331" y="76">level&gt;= water_median</label>
			<label kind="assignment" x="-263" y="68">level--</label>
			<nail x="-204" y="68"/>
			<nail x="-238" y="68"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id39"/>
			<label kind="guard" x="-408" y="-76">level==water_laag</label>
			<nail x="-272" y="-68"/>
			<nail x="-306" y="-34"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id39"/>
			<label kind="guard" x="-272" y="-119">level &lt; water_laag</label>
			<label kind="assignment" x="-238" y="-93">level++</label>
			<nail x="-204" y="-17"/>
			<nail x="-204" y="-68"/>
			<nail x="-238" y="-68"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id40"/>
			<label kind="guard" x="-408" y="153">pomp_clock&gt;=5 &amp;&amp; (level &gt;= water_laag &amp;&amp; level &lt;= water_median)</label>
			<label kind="synchronisation" x="-246" y="93">rood?</label>
			<label kind="assignment" x="-272" y="119">level:=water_laag, pomp_clock:=0</label>
			<nail x="-170" y="102"/>
			<nail x="-34" y="102"/>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id40"/>
			<label kind="guard" x="59" y="119">pomp_clock&gt;5 &amp;&amp; (level &lt;= water_hoog &amp;&amp; level &gt; water_median)</label>
			<label kind="synchronisation" x="68" y="102">rood?</label>
			<label kind="assignment" x="59" y="136">level:=water_hoog, pomp_clock:=0</label>
			<nail x="170" y="102"/>
			<nail x="34" y="102"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id38"/>
			<label kind="synchronisation" x="51" y="-144">high_water_level?</label>
			<label kind="assignment" x="52" y="-102">pomp_clock:=0</label>
			<nail x="34" y="-102"/>
			<nail x="170" y="-102"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="-152" y="-119">low_water_level?</label>
			<label kind="assignment" x="-152" y="-102">pomp_clock:=0</label>
			<nail x="-34" y="-102"/>
			<nail x="-170" y="-102"/>
		</transition>
	</template>
	<system>// Place template instantiations here.
Process = Template();
// List one or more processes to be composed into a system.
system Process;
    </system>
	<queries>
	</queries>
</nta>
