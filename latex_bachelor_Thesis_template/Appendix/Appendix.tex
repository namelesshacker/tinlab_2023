


\section{Research case: De digitale aanval op de Oekrainese krachtcentrale}
Dit verslag geeft inzage in een analyse van de Ukraine cyber aanval,
inclusief hoe de actoren zich zelf toegang gavan tot het controle systeem, welke methoden de acoren hebben gebruikt voor reconnaissance en vastleggen van het systeem, een gedetailleerde omshrijving van de aanval op 15 December 2015, en de methoden die gebruikt zijn door de aanvallers om hun sporen uit te wissen en daarmee het het stoppen van schade toebrengen  nog moeilker maken. Daarnaast wordter  een gedetailleerde omschrijving gevevenv an de beveiliging van de SCADA ccontrol systemen gebaeerd op bst practices, inclusief het control network ontwerp, technieken voor whtelisting, monitoring en loggen, en  opleiding van personeel.

https://na.eventscloud.com/file_uploads/aed4bc20e84d2839b83c18bcba7e2876_Owens1.pdf
https://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/
https://www.boozallen.com/content/dam/boozallen/documents/2016/09/ukraine-report-when-the-lights-went-out.pdf
https://www.reuters.com/article/us-ukraine-cybersecurity-sandworm-idUSKBN0UM00N20160108
https://www.mandiant.com/resources/blog/ukraine-and-sandworm-team
https://www.ifri.org/sites/default/files/atoms/files/desarnaud_cyber_attacks_energy_infrastructures_2017_2.pdf
https://ris.utwente.nl/ws/files/6028066/3-s2_0-B9780128015957000227.pdf
https://repositorio-aberto.up.pt/bitstream/10216/119066/2/315683.pdf
https://www.diva-portal.org/smash/get/diva2:1046339/FULLTEXT01.pdf
https://www.vice.com/en/article/zmeyg8/ukraine-power-grid-malware-crashoverride-industroyer



Oop 23,december 2015  vind er een cyber aanval plaats op het elektriciteitsnet van de Oekraine. Dit was de eerste bekende aanval op een elektrisch controle  system met corrupte firmware. Daarnaas wordt er een telecom-based denial of service attack met  geautomatieerde systemen om het telefoonverkeer uit te schakelen.
\cite{Whitehead2017ukrainepoweroutage}

Uit onderzoek\cite{zetter2016GridHack} naar de aanval,  uitgevoerd door Oekraiene sen Amerikaanse militairenblijkt  bleek onder meer dat de power grids in sommige gevallen beter waren beveiligd dan de Amerikaanse. Desondanks was de viligheid niet optimaal door onder andere de  hetgegeven dat werknemers op afstand konden inloggen en geen gebruik van 2-stapsverificatie.


\subsection{Literaire analyse}

\subsubsection{Motief}
Oekraine wijst naar de russen \cite{zetter2016GridHack}
https://www.wired.com/story/russian-hackers-attack-ukraine/
https://www.boozallen.com/content/dam/boozallen/documents/2016/09/ukraine-report-when-the-lights-went-out.pdf
https://www.reuters.com/article/us-ukraine-cybersecurity-sandworm/u-s-firm-blames-russian-sandworm-hackers-for-ukraine-outage-idUSKBN0UM00N20160108
https://www.reuters.com/article/us-ukraine-crisis-cyber-idUSKBN15U2CN
https://theconversation.com/cyberattack-on-ukraine-grid-heres-how-it-worked-and-perhaps-why-it-was-done-52802
https://jsis.washington.edu/news/cyberattack-critical-infrastructure-russia-ukrainian-power-grid-attacks/
\subsubsection{Situatie Oekraiene}
https://www.dragos.com/wp-content/uploads/CrashOverride-01.pdf
https://www.dragos.com/wp-content/uploads/CRASHOVERRIDE.pdf
\subsubsection{Situatie algemeen}
https://www.politico.eu/article/ukraine-cyber-war-frontline-russia-malware-attacks/
https://www.ifri.org/sites/default/files/atoms/files/desarnaud_cyber_attacks_energy_infrastructures_2017_2.pdf
https://www.cybersecurityintelligence.com/blog/attack-on-ukraines-power-grid-targeted-transmission-stations-4530.html

\subsubsection{Factoren}
http://web.mit.edu/smadnick/www/wp/2016-22.pdf
\subsubsection{Oorzaak}
https://www.sans.org/blog/confirmation-of-a-coordinated-attack-on-the-ukrainian-power-grid/
https://arstechnica.com/information-technology/2017/06/crash-override-malware-may-sabotage-electric-grids-but-its-no-stuxnet/
https://www.darkreading.com/threat-intelligence/first-malware-designed-solely-for-electric-grids-caused-2016-ukraine-outage
https://www.dragos.com/wp-content/uploads/CRASHOVERRIDE.pdf
\subsubsection{Gebruikte materialen}
https://en.wikipedia.org/wiki/2015_Ukraine_power_grid_hack
https://www.cisa.gov/news-events/alerts/2017/06/12/crashoverride-malware
https://rhebo.com/en/service/glossar/industroyer-25114/


\subsubsection{Uitvoering van de aanval}
https://na.eventscloud.com/file_uploads/aed4bc20e84d2839b83c18bcba7e2876_Owens1.pdf
https://www.boozallen.com/content/dam/boozallen/documents/2016/09/ukraine-report-when-the-lights-went-out.pdf
\subsubsection{Oplossingen}
https://na.eventscloud.com/file_uploads/aed4bc20e84d2839b83c18bcba7e2876_Owens1.pdf
https://www.cisa.gov/news-events/ics-alerts/ir-alert-h-16-056-01
\subsubsection{Aanbevelingen}

\subsection{Resultaten}
\subsubsection{De aanval}
1. An initial email spear phishing attack lures recipients
into opening an attached Microsoft® document with a
macro that installs Black Energy 3 (BE3) onto
corporate workstations.
2. BE3 and other tools perform reconnaissance and
enumeration of the network and provide an initial
backdoor for the hackers into the corporate network.
3. As a result of network reconnaissance, the malicious
actors discover and access the oblenergos’ Microsoft
Active Directory® servers that contain corporate user
accounts and credentials.
4. With the harvested credentials, the malicious actors use
an encrypted tunnel from an external network to get
inside the oblenergo network, establishing a presence
on the oblenergo control system networks.
5. Malicious actors discover and access the control center
supervisory control and data acquisition (SCADA)
human-machine interface (HMI) servers and
substations. While a router separates corporate and
SCADA networks, the firewall rules are improperly
configured.
6. On December 23, 2015, at 3:30 p.m., the malicious
actors begin their power outage attacks by entering
operations and SCADA networks through backdoors on
the compromised SCADA workstations. The malicious
actors take control away from HMI operators and then
open breakers.
7. The malicious actors perform several other actions with
the intent of complicating the responses of control
operators and increasing the effort required to return the
system to normal operating conditions. These actions
include:
a. Launching a coordinated Telephony Denial of
Service (TDoS) attack that floods call centers to
prevent legitimate calls from getting through.
b. Disabling the UPSs for the control centers.
c. Corrupting the firmware on a remote terminal unit
(RTU) HMI module and serial-to-Ethernet port
servers.
8. Malicious actors execute KillDisk malware in an
attempt to wipe out the control center HMIs and pivotpoint workstations.
https://na.eventscloud.com/file_uploads/aed4bc20e84d2839b83c18bcba7e2876_Owens1.pdf
https://www.boozallen.com/content/dam/boozallen/documents/2016/09/ukraine-report-when-the-lights-went-out.pdf
\subsubsection{spearfishing}
\subsubsection{blackenergy}
\subsubsection{remote access capabilities}
\subsubsection{serial-to-ethernet communication devices}
\subsubsection{telephony denial of service attacks}

\subsection{oplossingen}
Identificeer alle risicos en schrijf een plan foor het managen van de risico's.
Implementeer  effecteve controle  om het riico te managen.
Creeer een diepgaand model dat ervoor zor dat er efectieve en efficiente security controls worden uitgevoerd.
Aangaande de gebeurtenissen in de oekraiene kunnen de volgende security controls worden opgenomen in het securitymodel: Initial access to enterprise network, pivot in interprise network, elevate priviliges, maintainance access, gain access to control system, attack, attack complication, destroy hard drives.
\cite{Whitehead2017ukrainepoweroutage}

\subsection{Discussie}

\subsection{Verder lezen}
https://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=0513EED48102FDAD1BD940260EF12B11?doi=10.1.1.548.7490&amp;rep=rep1&amp;type=pdf
https://scialert.net/fulltext/?doi=tasr.2014.396.405
https://www.researchgate.net/publication/333671061_Attacking_IEC-60870-5-104_SCADA_Systems
https://www.welivesecurity.com/wp-content/uploads/2017/06/Win32_Industroyer.pdf
https://blog.nettedautomation.com/2017/
https://arxiv.org/pdf/2001.02925.pdf
https://dl.acm.org/doi/fullHtml/10.1145/3381038
https://www.win.tue.nl/~setalle/2017_fauri_encryption.pdf
http://www.connectivity4ir.co.uk/article/175490/IEC-62351--Secure-communication-in-the-energy-industry.aspx
https://www.virsec.com/resources/blog/virsec-hack-analysis-deep-dive-into-industroyer-aka-crash-override
https://dreamlab.net/en/blog/post/fuzzing-ics-protocols/
https://www.blackhat.com/docs/us-17/wednesday/us-17-Staggs-Adventures-In-Attacking-Wind-Farm-Control-Networks.pdf
https://blog.checkpoint.com/research/crashoverride/
https://www.blackhat.com/us-17/briefings/schedule/#industroyercrashoverride-zero-things-cool-about-a-threat-group-targeting-the-power-grid-6159
https://search.abb.com/library/Download.aspx?DocumentID=9AKK107045A1003&amp;LanguageCode=en&amp;DocumentPartId=&amp;Action=Launch
https://iiot-world.com/ics-security/cybersecurity/five-cybersecurity-experts-about-crashoverride-malware-main-dangers-and-lessons-for-iiot/
https://www.csoonline.com/article/3200828/crash-override-malware-that-took-down-a-power-grid-may-have-been-a-test-run.html
https://www.paloaltonetworks.com/blog/2017/06/crashoverrideindustroyer-protections-palo-alto-networks-customers/
https://www.webopedia.com/definitions/crashoverride-industroyer-malware/
https://www.cyber.nj.gov/threat-center/threat-profiles/ics-malware-variants/crashoverride
https://www.nixu.com/blog/crashoverride-threat-electricity-networks
https://www.virusbulletin.com/virusbulletin/2019/03/vb2018-paper-anatomy-attack-detecting-and-defeating-crashoverride/
https://en.wikipedia.org/wiki/Crash_Override_Network
https://en.wikipedia.org/wiki/Industroyer
https://www.dragos.com/resource/crashoverride-analyzing-the-malware-that-attacks-power-grids/
https://www.wallix.com/blog/ics-security-russian-hacking
https://www.nixu.com/fi/node/53
https://control.com/forums/threads/comparison-between-iec60870-5-103-and-modbus-rtu.20317/





\usepackage{pgf}
%\newcommand\setform{\pgfqkeys{/form }}
%\setform{field1/.store in=\fieldi,
	%	field2/.store in=\fieldii,
	%}


%\addtolength{\oddsidemargin}{-.875in}
%\addtolength{\evensidemargin}{-.875in}
%\addtolength{\textwidth}{1.75in}

%\addtolength{\topmargin}{-.875in}
%\addtolength{\textheight}{1.75in}


\newcommand\myform{%
	\fboxrule=0.4pt
	
	
	\fbox{\begin{minipage}{\textwidth}
			\fbox{\begin{minipage}[t][3cm][t]{0.25\textwidth}
					Betrokken partij
			\end{minipage}}%
			\fbox{\begin{minipage}[t][3cm][t]{0.25\textwidth}
					Verantwoordelijk
			\end{minipage}}%
			\fbox{\begin{minipage}[t][3cm][t]{0.44\textwidth}
					datetimestamp here
			\end{minipage}}
			\fbox{\begin{minipage}[t][1cm][t]{0.98\textwidth}
					Korte notitie 
			\end{minipage}}
			
	\end{minipage}}
	
	\fbox{\begin{minipage}{\textwidth}
			
			\fbox{\begin{minipage}[t][3cm][t]{0.98\textwidth}
					test
			\end{minipage}}
	\end{minipage}}
	
	\fbox{\begin{minipage}{\textwidth}
			\fbox{\begin{minipage}[t][10cm][t]{0.98\textwidth}
					Foto incident
			\end{minipage}}%
			
			
	\end{minipage}}
}



\setform{field1 = G. Wales,
	field2 = Mathematics}
\myform


 
 
 
 
 
 
 
 \section{Bijlage: Testcases en resultaten}
 \subsection{Wat wordt getest en hoe}
 
 
 \subsection{Requirement specification in queries}
 
  %\VerbatimInput{mydata.txt}
  \begin{verbatim}
 Sluis.Draining-->Deuren.laag_open
 Deuren.laag_open-->Stoplicht.Green
 E<> (Ship.ship_can_move&&Stoplicht.Green)
 A[] not (Stoplicht.Green && not (Deuren.hoog_open||Deuren.laag_open||Deuren.stopgaplow1||Deuren.stopgaplow2||Deuren.stopgaphigh1||Deuren.stopgaphigh2))
 A[] not ((Deuren.hoog_open||Deuren.laag_open||Deuren.Opening_laag||Deuren.Opening_hoog||Deuren.Closing_hoog||Deuren.Closing_laag) && (Sluis.Draining||Sluis.Filling||Sluis.draining2||Sluis.Filling2))
 Sensor.Wait-->Sensor.Wait
 Stoplicht.Green-->Stoplicht.Green
 (Deuren.hoog_open||Deuren.laag_open)-->(Deuren.laag_open||Deuren.hoog_open)
 Deuren.laag_open-->Deuren.Closed
 Deuren.hoog_open-->Deuren.Closed
 Deuren.Closed-->Stoplicht.Red
 Ship.ship_can_move-->Deuren.Closed
 Deuren.hoog_open-->Stoplicht.Green
 Ship.ship_can_move-->Stoplicht.Green
 A[] not (Deuren.laag_open && Deuren.hoog_open)
 Ship.ship_can_move-->Ship.ship_can_move
 A[] not (Deuren.laag_open && Sluis.water != Sluis.water_laag)
 A[] not (Deuren.hoog_open && Sluis.water != Sluis.water_hoog)
 A[]not deadlock
  \end{verbatim}
 P1 Het is mogelijk dat de sluis van richting verandert.
  E<> !Main.Direction
 P2 Het is mogelijk dat de sluispomp in een cyclus teveeel water heeft gepompt en dat er daardoor water weggepompt dan wel bijgekompt dient te worden
 E<> main.waterlevel
 P3 Het is al binnen 100 ms mogelijk omte achterhalen aan welke kant de sluisdeuren  open moeten.
 P4 Als de richting van een schip gelijk is aan N, dan is het waterlevel niet gelijk aan 1-5 of R
 P5 De sluispomp is nooit in positie AAN, wanneer de sluisdeuren open zijn.
 P6 In het geval dat er geen errors zijn (  in de stoplichten, sluisdeuren) and ideal (wachtrij) scenario,
 a) dan is een cyclus gegarandeerd binnen 100 ms (including 100 ms) (undefined)
 a') dan is een cyclus niet gegarandeerd binnen 100 ms
 b)  dan is het onmogelijk om van beneden naar boven te varen, of andersom binnen 150 ms
 b') dan is het mogelijk om van beneden naar boven te varen, of andersom binnen 150 ms
 c) het is onmogelijk om van richting te veranderen in minder dan 400 ms als de pomp al op niveau x is
 c') het is mogelijk om van richting te veranderen in minder dan 400 ms als de pomp al op niveau x is
 P7 Als zich geen errors voordoen bij stoplicht en deur,maar de waterpomp uitvalt:
 a)  a gear switch is gearanteerd after 1055 ms ( not including  1055)  (deleted)
 a') it is impossible  to switch gear in 1055 ms     (deleted)
 b) it is  impossible to switch gear in less than 550 ms (deleted)
 b') it is possible to switch gear at 550 ms (deleted)
 c) it is impossible to switch  gear in  less than 700 ms if the switch is not from/to gear N (deleted)
 c') it is posible to switch gear at 700 ms if the switch is not from/to gear N (deleted)
 
 
 p8 When no error occurs, but engine fails to find synchronous speed
 a) a gear switch is guaranteerd in 1205 ms (incuding 1205)
 a') a gear switch is not gearanteerd at less than 1205 ms
 b) it is imposible to switch gear in less than 450 ms
 b') is is possible to switch gear at 450 ms
 c) it is impossible to switch gear in less than 750 ms if the switch is not from/to gear N
 c') it is not possible to switch gear at 750 ms if the switch is not from/to gear N
 
 
 p9 Clutch errors
 a)If the clutch is not closed properly (i.e. a timeout occurs) the gearbox  controller will enter the locationCCCloseError with 200 ms   (undefined)
 b)  When the gearbox controller enters location CCloseError, there is always a problem in the clutch with closing the clutch.  (undefined)
 a) If th clutch is not closed properly (ie. a timeout occurs) the gearbox controller will enter the location CCloseError within 200 ms (undefined)
 b) When the gearbox controller enters location CCloseError, there is always a problem in the clutch with closing the clutch. (undefined)
 
 
 p10 Gearbox errors  
 a) If the gearbox can not enter a requested gear ( i.e. a tieout occurs) the gearbox controller will enter the location GsetError within 350 ms (undefined)
 b) When the gearbox controller enters location GSetError, there is always a problem in the gearbox with setting the gear. (undefined)
 
 
 p11 IF no error occurs in the engine, it is guaranteed to find synchronous speed (undefined)
 p12 Wanneer beide sluisdeuren in state gesloten zijn, dan is de pomp in zijn initiale state of 100 ms verwijderd van zijn initiele state
 A[]
 p13 When the gear controller has a greater set, torque regulaton is always indicated in the engine (undefined)
  A[]
 p14
 a) Als de deur open is(ongeacht boven of beneden, dan bevind de sluispomp zich in een  predefined state (undefined)
 A[] (gate(0).open||gate(1).open) -> (main.pomp_idle || main.pomp2_idle)
 b) Als de deur is gesloten dan bevind de maincontroller zich in een predefined state
 A[] gate.closed -> main.idle
 p15
 p16 If engine regulation is on torque, then the clutch is closed (undefined)
 A[](Engine.Torque imply Clutch.closed
 p17Voor invaren geldt altijd: waterlevel, pomp uit, sluisdeuren open en stoplicht op groen
 A[] main.s5 -> main.waterlevel_laag && idle_pomp1 && gate(0).open && gate(1).open && (stoplight(0).green && stoplight(1).green || stoplight(2).green && stoplight(3).green )
 p18 Als een schip van rechts binnen komt en sluisdeuren zijn dicht dan moet het stoplicht op rood, de pomnp in transitie van laag naar hoog en niet andersom
 A[] !main.direction -> forall (i:id_d) forall (j:id_s) gate(i).closed && stoplight.rood && main.rd_1
 p19 uitvarenden hebben voorang op invarenden
 
 p20 Voor invarenden geldt pomp uit, sleusdeur open en stoplicht op groen
 A[] main.s6 -> gate(0).open && gate(1).open && stoplight(0).groen && stoplight(1).groen
 p21 voor nivelleren geldt pomp is aan, sluisduren zijn doicht en het stoplicht is op rood
 A[] (main.rn1 || main.rn2) -> forall (i:id_d) forall(j:id_s )gate(i).closed stoplight(j).rood
 p22 Als een schip vertrekt dan zijn altijd, sleusdeuren open, waterlevel gereed op niveau 5 of 0 en stoplicht direct op groen
 A[] main.s12 ->
 p23 urgent locations; het is niet mogelijk om hier te wachten
 p24 urgent syn; een synchronisatie moet direct worden uitgevoerd als de guards geldig zijn
 p25 als een schip binnen is, en er zijn wachtende schepen, dan moet het stoplicht via oranje naar rood
 A[]
 p26 committed; als deze staat actief is dan wordt de eerst volgende transitie uitaande van deze state
 p27 als een schjip binnen vaart mnoiet hij ook eft binnen zijn en niet binnenvaren, dit geldt ook voor p28 sluisdeuren en pompen dus deze zijn committed.
 A[]
 p28 Een schip komt aanvaren en geeft een signaal aan de sluis. 
 A[]	
 p29 Indien er meer dan twee schepen in de sluis zitten dan wordt het ship geplaats in de wachrij. 
 A[]  Queue.list[N-1] == 2 -> (Sluiskolk.list[N]==1 ||Sluiskolk.list[N]==2)
 p30 Een schip kan pas naar binnenrijden als de sluisdeuren open zijn, het stoplicht is op groen er er zijn minder dan 2 schepen in de sluis. 	
 A[]  main.s6 && schip.varen ->  Queue.list[N-1] <2
 p32 Eenmaal in de sluis zal het schip moeten wachten op de sluis en de pomp. 	
  A[] Queue.list[N-1] == 2 
 p33 Een schip mag alleen uitvaren als de pomp klaar is, de sleusdeuren open. 
  A[] schip.varen && main.s12 || main.s13 -> (!main.rn1 && !main.rn2)
 p34 Een sluis ontvang een aankomst signaal van een schip en bestuurt de sluisdeuren en de pomp. 
  A[]
 p35 De sensor is een onderdeel van de sluis en ontvangt signalen van naderende schepen. 
  A[]
 p36 De sleusdeur voor boven en beneden kunnen beiden open en dicht. De sluisdeur wordt aangestuurd door de sluis. 
  A[]
 p37 Een pomp begint met pompen bij een signaal van de sluis. Een sluis op zijn beurt geeft alleen een signaal aan de pomp als de sleudeuren dichtzijn
  A[] pomp.pomp_active -> main.s6 && forall(i:id_d) gate(i).closed
 p38 Geen deadlock
 p39 Voor geen enkel pad geldt dat als  de deuren gesloten zijn volgens de kluis dat er een deur openstaat om een schip naar buiten te laten.
 A[] not forall(i:id_d) gate.closed ->(main.s12||main.s13)
 p40 Voor alle paden geld dat als een sluis aan het voorbereiden is, dan zijn alle deuren dcht.
 A[] main.s6 -> forall(gate(0).closed
  p41 Voor alle paden geld dat als een deur dicht is het aantal schepen in de kade gelijk is aan nul	
 A[]
 p42 Voor geen enkel pad geld dat als het binnenstoplicht op groen staat dat het niet toegestaan in naar binnen te varen
 E<> stoplight(2).groen || stoploght(3).groen -> main.s6
 p43 Voor alle paden geldt dat de globale tijd langer is dan 30 tijdseenheden
 A[] main.s13-> main.processtime>30
 p44 Er is een pad waarvoor geld dat als een schip wilt stoppen dat er meer dan 5 schepen in de sluis zitten.
 E<>
 p45 Voor alle paden geldt als schip vrtrekt is sluisdeur dicht
 A[] 
 p46 Voor alle paden geldt als stoplicht op rood sluisdeuren dicht en schip vertrokken dan is de nivelleermachine uit
 A[]
 p47 Er is geen pad waarop een schip vertrekt vanuit de rechtersluisdeur en de linkersluisdeur is open en linkeruitaartstoplicht en linkeruitvaartsoplicht opgroen  en nibelleermachine is aan
 E<>
 p48 Er is een pad waarvoor geldt dat linkerslsuisdeuren dicht zijn, rechtersluisdeuren dicht zijn rechteruitvaartstoplicht is rood en rechteruitvaartstoplicht is  rood terwijl eer geen schip in de sluis licht
 E<> 
 p49 EEn stoplich staat altijd op groen als de deuren open staan en de pomp niet bezig is.
 A[] forall(i:id_s) stoplight.groen -> gate(0).open && gate(1).open && (main.pomp1_idle || main.pomp2_idle)
 p50 In geen enkele staat van de sluis behalve tussen de lowergate en uppergate en uppergate en lowergate en de staten AtArrivalLow en AtEnteringHigh is de wachttijd langer dan 5 tijdseenheden
 A[] not
 p51 Voor alle paden in een pomp geldt dat als water level lager is dan waterlaag pompwaterweg is altijd false
 A[] (main.waterlevel<waterlaag) -> (!pompwaterweg||pompwaterweg==false)
 p52 Voor alle paden gelft dat als water level hoger is dan waterhoog dan is pompwater altjd false
 A[]
 p53 Het zal nooit gebeuren dat een pomp water toevoegt als deuren open zjn, geen schip in sluis en stoplicht op groen
 A[] not main.rn1 || main.rn2 -> gate(0).open && gate(1).open && Queue.list[N-1] == 0 && ((stoplight(0).groen||stoplight(1).groen) ||(stoplight(3).groen &&stoplight(4).groen))
 p54 Het kan gebeuren dat bij pompr het stoplicht op rood staat, het schip in de sluis en deur is dicht, en waterstand gelijk aan waterlaag
 E<> (main.blocked1 || main.blocked2) -> Queue.list[N-1] >0 && gate(0).closed && gate(1).closed && main.waterlevel==main.waterlevel_laag
 p55 Er is een mogelijkheid  dat vanuit pomp get stoplicht op rood wordt gezet en waterlevel gelijk is aan waterlaag
 E<> main.rn1||main.rn2 -> gate(0).closed &&main.waterlevel==waterlaag
 p56 Het kan voorkomen dat bij state pompaan het waterniveau gelijk is aan waterlaag
 E<> main.rn1||main.rn2 -> main.waterlevel== main.waterlaag
 p57 Voor alle paden gelt dat er een mogelijkheid is dat deur is open/dicht en sluis nivelleert omhoog/omlaag
 A[] gate(0).open && ()main.direction ==0||main.direction==1)
 p58 A[](1>0)
 
 
 
 
 \subsection{Operator: AG}
 Voor alle paden
 
 
 \subsection{Operator: EG}
 Uiteindelijk geldt er een pad waarvoor geldt
 
 \subsection{Operator: AF}
 Voor alle paden/richtingen vroeg of laat
 \subsection{Operator: EF}
 Er is een pad
 \subsection{Operator: AX}
 Alle opvolgende toestanden
 
 ~\cite{locke_2020}
 \subsection{Operator: EX}
 Er bestaat vanaf de volgende minstens 1 state waarvoor geldt
 \subsection{Operator: p U q}
 Er geldt p tot q
 ~\cite{gnsguides}
 \subsection{Operator: p R q}
 q moet waar zijn totdat en inclusief de situatie dat p voor het eerst waar is, als p niet geldig is, dan moet q vooraltjd geldig zijn
 
 
 \subsection{De computation tree}
 
 \subsection{Operator: AG}
 
 \subsection{Operator: EG}
 
 
 Voor alle paden geldt dat waterlevel lager is dan niveau van de kant.
 Voor alle paden geldt dat een omp werkzaam is als alle sluisdeuren dicht zijn.
 Vpoor alle paden geldt dat het aantal schepen in de sluis maximaal 2 is.
 Voor alle padedn  geldt dat een schip nooit langer dan 30 seconden in een sluiskolk zit zonder dat het waterpeil is aangepast.
 \subsection{Operator: EG}
 Er bestaat op elk pad een 
 
 \subsection{Operator: AF}
 
 \subsection{Operator: EF}
 r is soms een mogelijkheid dat twee schepen in de sluis een verschillende uitvaarrichting hebben.
 \subsection{Operator: AX}
 
 
 \subsection{Operator: EX}
 
 \subsection{Operator: p U q}
 
 \subsection{Operator: p R q}
 
 
 Voor alle paden geldt dat een schip alleen kan invaren als de sluisdeur aan de andere zijde is gesloten.
 \subsection{Operator: EX}
 Er bestaat geen situatie dat een pomp actief is terwijl er een sluisdeur open staat
 \subsection{Operator: p U q}
 Vanaf aankomst tot uitvaren is de clocktijd lager dan 30 tijdseenheden 
 \subsection{Operator: p R q}
 Vanaf invaren tot en met uitvarenvan een schip en geldig is x lager dan 15 tijdseenheden
 vanaf aanvaren staat een schip maximaal 40 tijdseenheden in de wahtrij,.
 
 \subsection{Operator: AF}
 Er is altijd meerdere
 \subsection{Operator: EF}
 r is soms een mogelijkheid dat twee schepen in de sluis een verschillende uitvaarrichting hebben.
 \subsection{Operator: AX}
 Voor alle paden geldt dat een schip alleen kan invaren als de sluisdeur aan de andere zijde is gesloten.
 \subsection{Operator: EX}
 Er bestaat geen situatie dat een pomp actief is terwijl er een sluisdeur open staat
 \subsection{Operator: p U q}
 Vanaf aankomst tot uitvaren is de clocktijd lager dan 30 tijdseenheden 
 \subsection{Operator: p R q}
 Vanaf invaren tot en met uitvarenvan een schip en geldig is x lager dan 15 tijdseenheden
 vanaf aanvaren staat een schip maximaal 40 tijdseenheden in de wahtrij,.
 
 \subsection{Fairness}
 
 \subsection{Liveness}
 
 
 
 
 \chapter{Testresultaten CTL logica}
 
 
 
 \begin{center}
 	\begin{gather*}
 		D=\Set{x\in\nat}{1\le x\le 100}\\
 		D=\Set[\big]{x\in\nat}{1\le x\le 100}\\
 		D=\Set[\Big]{x\in\nat}{1\le x\le 100}\\
 		D=\Set[\bigg]{x\in\nat}{1\le x\le 100}\\
 		D=\Set[\Bigg]{x\in\nat}{1\le x\le 100}\\
 		D=\Set*{x\in\nat}{1\le x\le \frac{200}{2}}
 	\end{gather*}
 \end{center}
 
 
 
 
 
 $S is a set of finite states$\\
 $S0 \subseteq S is de set van initiele statess$ \\
 $S0 \subseteq S xS  is een transitie relatie die totaal moet zij, dat betekent, dat voor elke state s \in S er een stats is s' \in S zodat R(s,s')$
 $L\stock a$
 
 $\forall x\,\exists y \implies $
 
 $\mtproforall x\,\mtproexists y \cap \subset \in \vee \diamondsuit \dashv \ni \pm$
 
 
 
 \begin{center}
 	\begin{tabular}{| l | c || r | }
 		\hline
 		1 &A[] !deadlock  &  TRUE \\ \hline
 		2 & A[] not (Sluis.Tussenstop5 \&\& Deur.Klaar\_voor\_uitvaart)  &  Disconnected \\ \hline
 		3 & A[]  (Sluis.Voorbereiden imply Deur.Dicht)   &  TRUE\\   \hline
 		4 &A[]  (Deur.Dicht imply Counter==0)   & TRUE  \\   \hline
 		5 & A[]  (Buitenstoplicht.Groen imply invaren\_allowed==true)  &  TRUE \\ \hline
 		6 & A[] ! (Binnenstoplicht.Groen imply invaren\_allowed==false)  & FALSE \\ \hline
 		7 & A[]  (globale\_tijd>30)   &  FALSE\\    \hline
 		8 & E<>  (Schip.Stoppen and (Counter >5))   & Ship not a structure  \\   \hline
 		9 & A[] (Schip.Vertrekken imply Sluisdeur.Dicht)  &  -  \\   \hline
 		\hline
 	\end{tabular}
 \end{center}
 
 
 
 %  https://www.stat.cmu.edu/~brian/latex/symbols/symbols.html
 % https://tex.loria.fr/ctan-doc/macros/latex/doc/html/fntguide/node18.html
 % https://observablehq.com/@s-haensch/latex-notation
 % http://tdc-www.harvard.edu/tdcprop1/help/symbols/
 % http://new.math.uiuc.edu/oldnew/netgeom/advice/to-texpad.html
 % https://www.overleaf.com/learn/latex/List_of_Greek_letters_and_math_symbols
 % https://jblevins.org/log/greek
 % https://latex-tutorial.com/symbols/greek-alphabet/
 % https://latex-programming.fandom.com/wiki/List_of_LaTeX_symbols
 % https://physicsanduniverse.com/latex-symbols-and-using-them-to-write-equations/
 % http://tug.ctan.org/info/symbols/comprehensive/symbols-a4.pdf
 % https://tex.stackexchange.com/questions/99772/how-to-insert-greek-letters-having-trouble-with-greekletter
 % https://texblog.org/2012/03/15/greek-letters-in-text-without-changing-to-math-mode/
 % https://www.avantixlearning.ca/microsoft-word/how-to-insert-greek-letters-or-symbols-in-microsoft-word/
 %
 %
 %
 
 
 
 
 
 
 \chapter{Time bound derivation}
 
 
 \paragraph{Verification results}
 
 
 %	\bankstatement[title={Kontoauszug 12/2014},
 %	openingbalance={-12,34},
 %	closingbalance={82,13}]{201412.csv}
 
 
 
 
 \subparagraph{verklareing}
 
 
 \begin{filecontents*}{mydata.csv}
 	1.8233,1.8233,1.8233,0.9243,0.8651,0.9013,0.3217,0.3377,34.4858
 	0.2753,0.2753,0.2753,0.5383,0.5038,0.5249,0.3217,0.3377,8.4552
 	0.0898,0.0898,0.0898,0.2804,0.2625,0.2734,0.3217,0.3377,1.5514
 	0.4689,0.1193,0.0417,0.8046,0.2227,0.1795,0.6413,0.3307,6.4488
 	0.339,0.8068,0.0936,0.4335,0.8036,0.2434,0.3046,0.624,20.8422
 	0.2162,0.133,0.8711,0.1707,0.1503,0.8215,0.1562,0.0692,2.3365
 	0.5187,0.9138,1.0432,0.4332,0.8028,0.8406,0.2269,0.3404,22.8164
 	0.58,0.2096,0.9086,0.808,0.2134,0.8294,0.333,0.1596,8.4349
 	0.8237,0.9378,0.0855,0.8654,0.8096,0.2487,0.4338,0.5187,26.9923 
 \end{filecontents*}
 
 \subsection{Fairness}
 AG(AF(p))
 \begin{verbatim}
 	In welke staat de automaat zich ook bevindt, in alle richtingen kom je vroeg of laat een state tegen, waarin p geldig is.
 \end{verbatim}
 \subsection{Liveness}
 \begin{verbatim}
 	Altijd en overal geldt: Als p geldt dan geldt vroeg of laat q
 	Ookal treedt p nooit p volgens de logica klopt het dan dat q volgt uit p.
 	In een situatie, waarin p nooit optreedt, spreekt men van een
 	vacuous truth.
 \end{verbatim}
 
 
 \VerbatimInput{mydata.csv}
 
 \subsection{safety}
 %\VerbatimInput{mydata.txt}
 
 \subsection{zeno vrij}
 Geen enkele state kan oneindig een transitie uitvoeren. Elke state heeft een uitgaande transitie.
 
 \subsection{deadlocks}
 %\VerbatimInput{data.txt}
 
 \newpage
 
 \section{\\ Appendix B: Model eerste deelname aan cursus 2020}
 % the \\ insures the section title is centered below the phrase: Appendix B
 

 
 
 
 \begin{verbatim}
 	
 	Queries
 	Sluis.Draining-->Deuren.laag_open
 	Deuren.laag_open-->Stoplicht.Green
 	E<> (Ship.ship_can_move&&Stoplicht.Green)
 	A[] not (Stoplicht.Green && not (Deuren.hoog_open||Deuren.laag_open||Deuren.stopgaplow1||Deuren.stopgaplow2||Deuren.stopgaphigh1||Deuren.stopgaphigh2))
 	A[] not ((Deuren.hoog_open||Deuren.laag_open||Deuren.Opening_laag||Deuren.Opening_hoog||Deuren.Closing_hoog||Deuren.Closing_laag) && (Sluis.Draining||Sluis.Filling||Sluis.draining2||Sluis.Filling2))
 	Sensor.Wait-->Sensor.Wait
 	Stoplicht.Green-->Stoplicht.Green
 	(Deuren.hoog_open||Deuren.laag_open)-->(Deuren.laag_open||Deuren.hoog_open)
 	Deuren.laag_open-->Deuren.Closed
 	Deuren.hoog_open-->Deuren.Closed
 	Deuren.Closed-->Stoplicht.Red
 	Ship.ship_can_move-->Deuren.Closed
 	Deuren.hoog_open-->Stoplicht.Green
 	Ship.ship_can_move-->Stoplicht.Green
 	A[] not (Deuren.laag_open && Deuren.hoog_open)
 	Ship.ship_can_move-->Ship.ship_can_move
 	A[] not (Deuren.laag_open && Sluis.water != Sluis.water_laag)
 	A[] not (Deuren.hoog_open && Sluis.water != Sluis.water_hoog)
 	A[]not deadlock
 	
	
 \end{verbatim}
 
 \newpage
 \section{\\ Appendix B: Model herkansing tweede deelname aan cursus 2020}
 % the \\ insures the section title is centered below the phrase: Appendix B
 

 
 \begin{verbatim}
 	// Place global declarations here.
 	/*
 	Project working
 	
 	AtArrival
 	StoplightRed
 	DoorOpen
 	StoplightGreen
 	Startmove
 	Sensor
 	SchipEntered
 	Doorclosed
 	StoplightRed
 	---------
 	Nivelleer started
 	NIvelleer stopped
 	Waterlevel equilibrium
 	-----------
 	AtLeaving
 	Stoplightred
 	Dooropened
 	Stoplightgreen
 	StartMove
 	Sensor
 	SchipHasLeft
 	Doorclosed
 	StoplightRed
 	
 	
 	Uitleg
 	Als het schip boven is, dan is waterlvel gelijk aan hoog, filling valve is dicht, lower gates zijn gesloten, uppergates zijn open,empty valve is dicht. 
 	Schip is in waterlock, waterlevel is hoog, filling valve is dicht, lower gates gesloten, upper gates gesloten, empty valve is open. 
 	Schip is dan laag, waterlevel gelijk aan laag, filling valve is dicht, lowergates zijn open, uppergates zijn dicht, empty valve is dicht.
 	AtArrivalHigh
 	
 	AtArrivalLow
 	Als schip beneden is dan is waterlevel gelijk aan laag, filling valve is dicht, lower gates zijn open, upper gates zijn dicht, empty valve is open. 
 	Schip is in water lock, waterlevel is laag, flilling valve is open, lower gates zijn gesloten, upper gates zij gesloten, empty valve is dicht,. 
 	Schip is dan hoog, waterlevel is gelijk aan hoog, filling valve is dicht, uppergates zijn open, lowergates zijn dicht, filling valve is dicht
 	
 	
 	*/
 	
 	const int N = 2;         // # trains
 	typedef int[0,N-1] id_t;
 	
 	chan        appr[N], stop[N], leave[N];
 	urgent chan go[N];
 	
 	// waterniveau in in meter van 0 tot 10
 	typedef int[3,10] waterniveau;
 	
 	waterniveau level;
 	
 	
 	//doors
 	chan lower_gate;
 	chan upper_gate;
 	//filling
 	chan emptying_valve;
 	chan filling_valve;
 	bool nivelleer_sessie_bezig;
 	// water level
 	chan high_water_level;
 	chan low_water_level;
 	//sluices
 	chan signal_sluis_low[N];
 	chan signal_sluis_high[N];
 	//
 	chan move[N];
 	//
 	chan groen;
 	chan rood;
 	
 	clock central;
 	
 	\\geef de schip parameter const id_t id
 	// Place local declarations here.
 	clock schip_clock;
 	
 	\\sensor declaraties
 	clock x;
 	
 	
 	
 	\\sluis declaraties
 	
 	const int water_laag=3;
 	const int water_hoog=10;
 	const int water_median=(water_hoog+water_laag)/2;
 	int[water_laag,water_hoog] water=water_median;
 	// level wordt gelijk gezet met temp
 	// temp is gelijk aan waterniveau
 	clock sluis_clock;
 	id_t list[N+1];
 	int[0,N] len;
 	bool contentHigh, contentLow;
 	// Put an element at the end of the queue
 	void enqueue(id_t element)
 	{
 		list[len++] = element;
 	}
 	
 	// Remove the front element of the queue
 	void dequeue()
 	{
 		int i = 0;
 		len -= 1;
 		while (i < len)
 		{
 			list[i] = list[i + 1];
 			i++;
 		}
 		list[i] = 0;
 	}
 	
 	// Returns the front element of the queue
 	id_t front()
 	{
 		return list[0];
 	}
 	
 	// Returns the last element of the queue
 	id_t tail()
 	{
 		return list[len - 1];
 	}
 	
 	
 	
 	\\stoplicht declaraties
 	clock stoplicht_clock;
 	
 	
 	
 	\\pomp declaraties
 	
 	const int water_laag=3;
 	const int water_hoog=10;
 	const int water_median=(water_hoog+water_laag)/2;
 	int[water_laag,water_hoog] water=water_median;
 	clock pomp_clock;
 	// waterniveau van de sensor voor de sluis is gelijk aan level
 	waterniveau depth;
 	
 	
 	
 	// een constraint op een bepaalde variabele
 	bool isForLow()
 	{
 		//	return false;
 		
 		if( level>=3) return true;
 		else return false;
 		
 	}
 	
 	bool isForHigh()
 	{
 		//	return false;
 		
 		if( level>=6) return true;
 		//else if(level>=6) return true;
 		
 		else return false;
 		
 	}
 	
 	
 	
 	//verschillende tijdseenheden voor even en oneven lampnummers
 	
 	
 	
 	
 	
 \end{verbatim}
 
 
 \chapter{Queries}
 \begin{verbatim}
 	
 	
 	
 	Project declaraties
 	//Declarations
 	
 	chan boot_hoog;
 	chan boot_laag;
 	chan changedoor_low;
 	chan changedoor_high;
 	chan ship_moves;
 	chan ship_abletomove;
 	chan changelight;
 	
 	\\Sluis declaraties
 	const int water_laag=0;
 	const int water_hoog=10;
 	const int water_median=(water_hoog+water_laag)/2;
 	int[water_laag,water_hoog] water=water_median;
 	clock x;
 	\\Stoplicht declaraties
 	
 	\\Ship declaraties
 	clock x;
 	\\Sensor declaraties
 	
 	\\Deuren declaraties
 	bool stoplicht_hoog=false;
 	bool stoplicht_laag=false;
 	clock x;
 	
 	
 	\\System declaraties
 	system Deuren,Sensor,Sluis,Ship,Stoplicht;
 	
 	
 	Uitleg
 	Als het schip boven is, dan is waterlvel gelijk aan hoog, filling valve is dicht, lower gates zijn gesloten, uppergates zijn open,empty valve is dicht. 
 	Schip is in waterlock, waterlevel is hoog, filling valve is dicht, lower gates gesloten, upper gates gesloten, empty valve is open. 
 	Schip is dan laag, waterlevel gelijk aan laag, filling valve is dicht, lowergates zijn open, uppergates zijn dicht, empty valve is dicht.
 	AtArrivalHigh
 	
 	AtArrivalLow
 	Als schip beneden is dan is waterlevel gelijk aan laag, filling valve is dicht, lower gates zijn open, upper gates zijn dicht, empty valve is open. 
 	Schip is in water lock, waterlevel is laag, flilling valve is open, lower gates zijn gesloten, upper gates zij gesloten, empty valve is dicht,. 
 	Schip is dan hoog, waterlevel is gelijk aan hoog, filling valve is dicht, uppergates zijn open, lowergates zijn dicht, filling valve is dicht
 	
 	
 	
 \end{verbatim}
 
 
 
 
 \section{Deelonderzoek naar veiligheidsrisico's en eisen voor sluizen}
 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \section{Deelonderzoek wet en regelgeving voor sluizen}
 
 
 
 Gevonden weblinks in google op 07-04-2023 met zoekopdracht: "wet en regelgeving voor sluizen"
 
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  
  
 \usepackage{pgf}
 \newcommand\setform{\pgfqkeys{/form }}
 \setform{field1/.store in=\fieldi,
 	field2/.store in=\fieldii,
 }
 
 
 %\addtolength{\oddsidemargin}{-.875in}
 %\addtolength{\evensidemargin}{-.875in}
 %\addtolength{\textwidth}{1.75in}
 
 %\addtolength{\topmargin}{-.875in}
 %\addtolength{\textheight}{1.75in}
 
 
 \newcommand\myform{%
 	\fboxrule=0.4pt
 	
 	
 	\fbox{\begin{minipage}{\textwidth}
 			\fbox{\begin{minipage}[t][3cm][t]{0.25\textwidth}
 					Naam vergadering
 			\end{minipage}}%
 			\fbox{\begin{minipage}[t][3cm][t]{0.25\textwidth}
 					Datum en plats
 			\end{minipage}}%
 			\fbox{\begin{minipage}[t][3cm][t]{0.44\textwidth}
 					Namen aanwezigen
 			\end{minipage}}
 			\fbox{\begin{minipage}[t][1cm][t]{0.98\textwidth}
 					Opening en goedkeuring
 			\end{minipage}}
 			
 	\end{minipage}}
 	
 	\fbox{\begin{minipage}{\textwidth}
 			
 			\fbox{\begin{minipage}[t][3cm][t]{0.98\textwidth}
 					Ingekomen stukken en rondvraag
 			\end{minipage}}
 	\end{minipage}}
 	
 	\fbox{\begin{minipage}{\textwidth}
 			\fbox{\begin{minipage}[t][10cm][t]{0.98\textwidth}
 					Sluiting
 			\end{minipage}}%
 			
 			
 	\end{minipage}}
 }
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 \newpage
 
 
 
 
 
 
 
 
 \begin{center}  
 	\begin{tabular}{ | l | l | l | p{5cm} |} % you can change the dimension according to the spacing requirements  
 		\hline  
 		\multicolumn{4}{|l|}{Actielijst} \\ \hline  
 		Onderwerp & Besluit & Wie &Gereed \\ \hline  
 		Orange & Fruit & Vitamin C & It is fruit, which is full of nutrients and low in calories. They can promote clear, healthy skin and also lowers the risk for many diseases. It reduces cholesterol and also helps in building a healthy immune system.\\ \hline  
 		
 		Cauliflower & vegetable & B-Vitamins & It is the vegetable, which is high in fiber and B-Vitamins. It also provides antioxidants, which help in fighting or protect against cancer. It enhances digestion and has many other nutrients.\\ \hline  
 		
 	\end{tabular}  
 \end{center}  
 
 
 
 
 \chapter{Testresultaten}
 
 
 
 \subsubsection{onderdeleel van de test}
 
 
 
 \begin{tabular}{*{15}{|l|l|l|l|l|l|l|}} \hline
 	\multicolumn{7}{|l|}{project name}                                                               \\ \hline
 	\multicolumn{4}{|l|}{Test case ID}   &\multicolumn{3}{|l|}{Test designed by}                           \\ \hline
 	\multicolumn{4}{|l|}{test priority (low/medium/high)}   &\multicolumn{3}{|l|}{Test design date}                           \\ \hline
 	\multicolumn{4}{|l|}{Module name}   &\multicolumn{3}{|l|}{Test executed by}                           \\ \hline
 	\multicolumn{4}{|l|}{Test title}   &\multicolumn{3}{|l|}{Test execution date}                           \\ \hline
 	\multicolumn{4}{|l|}{Description}   &\multicolumn{3}{|l|}{ }                           \\ \hline 		
 	\multicolumn{7}{|l|}{ }   																\\ \hline
 	\multicolumn{7}{|l|}{Pre condition}                                                               \\ \hline
 	\multicolumn{7}{|l|}{Dependencies}                                                               \\ \hline
 	\multicolumn{7}{|l|}{ }   															\\ \hline
 	Step  &  Test steps & Test data & expected result &Acual result &(pass or fail)&notes  \\ \hline
 	
 \end{tabular}
 
 
 
 
 
 \section{Modelleren}
 
 
 \section{Ethiek}
 
 
 \section{Conclusie}
 
 
 \chapter{Security}
 
 \section{Inleiding}
 
 \section{Resultaat}
 
